{"version":3,"file":"static/js/635.js","mappings":"iNAEA,GAAM,CAAEA,QAAAA,CAAO,CAAEC,YAAAA,CAAW,CAAE,CAAGC,SAEjC,MAAe,CACXC,SCLW,6+BDOXC,OACI,MAAO,CACHC,oBAAqB,GACrBC,YAAa,GACbC,IAAK,EACT,CACJ,EAEAC,QAAS,CACLC,8BAGI,OAFA,IAAI,CAACC,KAAK,CAAC,cAEJ,IAAI,CAACC,YAAY,CAAC,IAAI,CAACC,QAAQ,CAAE,IAAI,CAACC,QAAQ,CAAE,IAAI,CAACN,GAAG,EAC1DO,IAAI,CAAC,KACF,IAAI,CAACC,kBAAkB,GACvB,IAAI,CAACL,KAAK,CAAC,iBACf,GACCM,KAAK,CAAC,IACH,IAAI,CAACH,QAAQ,CAAG,GAChB,IAAI,CAACN,GAAG,CAAG,GACX,IAAI,CAACD,WAAW,CAAG,GAEnB,IAAI,CAACW,gBAAgB,CAACC,GACtB,IAAI,CAACR,KAAK,CAAC,iBACf,EACR,EAEAC,aAAaQ,CAAI,CAAEC,CAAI,CAAEb,CAAG,EACxB,OAAON,EAAYoB,YAAY,CAAC,QAAQC,UAAU,CAACC,IAAI,CAAC,eAAgB,CACpEC,WAAY,WACZC,UAAW,iBACXC,OAAQ,QACRd,SAAUO,EACVN,SAAUO,EACVO,WAAYpB,CAChB,EAAG,CACCqB,QAAS5B,EAAQ6B,GAAG,CAACC,OAAO,GAC7BhB,IAAI,CAAC,IACJ,IAAMiB,EAAO,IAAI,CAACC,YAAY,CAACC,uBAAuB,CAAC,CACnDC,OAAQhB,EAASd,IAAI,CAAC+B,YAAY,CAClCC,QAASlB,EAASd,IAAI,CAACiC,aAAa,CACpCC,OAAQpB,EAASd,IAAI,CAACmC,UAAU,GAKpC,OAFAC,OAAOC,YAAY,CAACC,OAAO,CAAC,oBAAqB,QAE1CX,CACX,EACJ,EAEAY,wBACI,IAAI,CAACtC,mBAAmB,CAAG,IAAI,CAACQ,QAAQ,CACxC,IAAI,CAAC+B,MAAM,CAAC,wBAChB,EAEA3B,iBAAiB4B,CAAK,EAClB,GAAIA,gBAAAA,EAAM3B,QAAQ,CAACd,IAAI,CAAC0C,MAAM,CAAC,EAAE,CAACC,MAAM,CAAoB,CACxD,IAAI,CAACH,MAAM,CAAC,mBAAoBC,GAChC,MACJ,CAEA,IAAI,CAAChC,QAAQ,CAAG,IAAI,CAACR,mBAAmB,CACxC,IAAI,CAACC,WAAW,CAAG,EACvB,CACJ,CACJ,C","sources":["webpack://administration/../../../../../../custom/static-plugins/RuneLaenenTwoFactorAuth/src/Resources/app/administration/src/override/sw-login/view/sw-login-login/index.js","webpack://administration/../../../../../../custom/static-plugins/RuneLaenenTwoFactorAuth/src/Resources/app/administration/src/override/sw-login/view/sw-login-login/sw-login-login.html.twig"],"sourcesContent":["import template from './sw-login-login.html.twig';\r\n\r\nconst { Context, Application } = Shopware;\r\n\r\nexport default {\r\n    template,\r\n\r\n    data() {\r\n        return {\r\n            rememberOtpPassword: '',\r\n            showOtpForm: false,\r\n            otp: '',\r\n        };\r\n    },\r\n\r\n    methods: {\r\n        loginUserWithPasswordAndOtp() {\r\n            this.$emit('is-loading');\r\n\r\n            return this.loginWithOtp(this.username, this.password, this.otp)\r\n                .then(() => {\r\n                    this.handleLoginSuccess();\r\n                    this.$emit('is-not-loading');\r\n                })\r\n                .catch((response) => {\r\n                    this.password = '';\r\n                    this.otp = '';\r\n                    this.showOtpForm = false;\r\n\r\n                    this.handleLoginError(response);\r\n                    this.$emit('is-not-loading');\r\n                });\r\n        },\r\n\r\n        loginWithOtp(user, pass, otp) {\r\n            return Application.getContainer('init').httpClient.post('/oauth/token', {\r\n                grant_type: 'password',\r\n                client_id: 'administration',\r\n                scopes: 'write',\r\n                username: user,\r\n                password: pass,\r\n                rl_2fa_otp: otp,\r\n            }, {\r\n                baseURL: Context.api.apiPath,\r\n            }).then((response) => {\r\n                const auth = this.loginService.setBearerAuthentication({\r\n                    access: response.data.access_token,\r\n                    refresh: response.data.refresh_token,\r\n                    expiry: response.data.expires_in,\r\n                });\r\n\r\n                window.localStorage.setItem('redirectFromLogin', 'true');\r\n\r\n                return auth;\r\n            });\r\n        },\r\n\r\n        loginUserWithPassword() {\r\n            this.rememberOtpPassword = this.password;\r\n            this.$super('loginUserWithPassword');\r\n        },\r\n\r\n        handleLoginError(error) {\r\n            if (error.response.data.errors[0].detail !== 'request-otp') {\r\n                this.$super('handleLoginError', error);\r\n                return;\r\n            }\r\n\r\n            this.password = this.rememberOtpPassword;\r\n            this.showOtpForm = true;\r\n        },\r\n    },\r\n};\r\n","export default \"{% block sw_login_login %}\\r\\n\\r\\n    <div v-if=\\\"!showOtpForm\\\">\\r\\n        {% parent %}\\r\\n    </div>\\r\\n    <div v-else>\\r\\n        <form class=\\\"sw-login-login sw-login-login-otp\\\" @submit.prevent=\\\"loginUserWithPasswordAndOtp\\\">\\r\\n            <h2 class=\\\"sw-login__content-headline\\\">{{ $tc('sw-login.index.headlineForm') }}</h2>\\r\\n\\r\\n            <sw-text-field\\r\\n                v-autofocus\\r\\n                v-model:value=\\\"otp\\\"\\r\\n                :label=\\\"$tc('rl-2fa.sw-login.index.labelOtp')\\\"\\r\\n                required>\\r\\n            </sw-text-field>\\r\\n\\r\\n            <div class=\\\"sw-login__submit\\\">\\r\\n                <sw-button :disabled=\\\"otp.length != 6 || password.length <= 0 || username.length <= 0\\\"\\r\\n                           class=\\\"sw-login__login-action\\\"\\r\\n                           variant=\\\"primary\\\">\\r\\n                    {{ $tc('sw-login.index.buttonLogin') }}\\r\\n                </sw-button>\\r\\n            </div>\\r\\n        </form>\\r\\n    </div>\\r\\n{% endblock %}\\r\\n\";"],"names":["Context","Application","Shopware","template","data","rememberOtpPassword","showOtpForm","otp","methods","loginUserWithPasswordAndOtp","$emit","loginWithOtp","username","password","then","handleLoginSuccess","catch","handleLoginError","response","user","pass","getContainer","httpClient","post","grant_type","client_id","scopes","rl_2fa_otp","baseURL","api","apiPath","auth","loginService","setBearerAuthentication","access","access_token","refresh","refresh_token","expiry","expires_in","window","localStorage","setItem","loginUserWithPassword","$super","error","errors","detail"],"sourceRoot":""}