(window["webpackJsonpPluginrune-laenen-two-factor-auth"]=window["webpackJsonpPluginrune-laenen-two-factor-auth"]||[]).push([[758],{950:function(){},758:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n}}),r(382);var n={template:'{% block rl_user_otp_user_card %}\r\n    <sw-card :title="$tc(\'rl-2fa.settings.user-detail.title\')"\r\n             :is-loading="isLoading || isLoading2Fa">\r\n        <div v-if="user && user.customFields && user.customFields.rl_2fa_secret">\r\n\r\n            <sw-alert variant="success"\r\n                      :title="$tc(\'rl-2fa.settings.user-detail.enabled.title\')"\r\n                      style="margin-bottom: 0;"\r\n                      :showIcon="true"\r\n                      :closable="false">\r\n                {{ $tc(\'rl-2fa.settings.user-detail.enabled.description\') }}\r\n\r\n                <template #actions>\r\n                    <sw-button @click="disable2FA">{{ $tc(\'rl-2fa.settings.user-detail.enabled.disable\') }}</sw-button>\r\n                </template>\r\n            </sw-alert>\r\n        </div>\r\n        <div v-else-if="!generatedSecretUrl">\r\n            <sw-alert variant="warning"\r\n                      :title="$tc(\'rl-2fa.settings.user-detail.not-enabled.title\')"\r\n                      style="margin-bottom: 0;"\r\n                      :showIcon="true"\r\n                      :closable="false">\r\n                {{ $tc(\'rl-2fa.settings.user-detail.not-enabled.description\') }}\r\n\r\n                <template #actions>\r\n                    <sw-button @click="generateSecret">{{ $tc(\'rl-2fa.settings.user-detail.not-enabled.get-started\') }}</sw-button>\r\n                </template>\r\n            </sw-alert>\r\n        </div>\r\n        <div v-else-if="generatedSecretUrl">\r\n            <sw-container columns="1fr 1fr">\r\n                <div class="rl-2fa-qr-code">\r\n                    <img :src="generatedSecretUrl" />\r\n                    <span class="rl-2fa-qr-code--secret">{{ generatedSecret }}</span>\r\n                </div>\r\n                <div>\r\n                    <b>{{ $tc(\'rl-2fa.settings.user-detail.generating.scan-code\') }}</b><br />\r\n                    <br />\r\n                    {{ $tc(\'rl-2fa.settings.user-detail.generating.description\') }}<br />\r\n                    <br />\r\n                    <sw-alert variant="error"\r\n                              :title="$tc(\'rl-2fa.settings.user-detail.generating.error-title\')"\r\n                              :showIcon="true"\r\n                              v-if="oneTimePasswordError.length > 0">\r\n                        {{ oneTimePasswordError }}\r\n                    </sw-alert>\r\n\r\n                    <sw-text-field label="One-time Password"\r\n                                   :isInvalid="oneTimePasswordError.length > 0"\r\n                                   v-model:value="oneTimePassword"\r\n                                   autocomplete="one-time-code"></sw-text-field>\r\n\r\n                    <sw-button @click="validateAndSaveOneTimePassword">\r\n                        {{ $tc(\'rl-2fa.settings.user-detail.generating.validate-save\') }}\r\n                    </sw-button>\r\n                </div>\r\n            </sw-container>\r\n        </div>\r\n    </sw-card>\r\n{% endblock %}\r\n',props:{user:{type:Object,required:!0},isLoading:{type:Boolean,required:!0},onSave:{type:Function,required:!0}},data(){return{httpClient:null,isLoading2Fa:!1,generatedSecret:null,generatedSecretUrl:null,oneTimePassword:"",oneTimePasswordError:""}},created(){this.syncService=Shopware.Service("syncService"),this.httpClient=this.syncService.httpClient},methods:{generateSecret(){this.isLoading2Fa=!0,this.httpClient.get("rl-2fa/generate-secret",{params:{holder:this.user.username}}).then(e=>{this.isLoading2Fa=!1,this.generatedSecret=e.data.secret,this.generatedSecretUrl=e.data.qrUrl})},validateAndSaveOneTimePassword(){this.isLoading2Fa=!0,this.httpClient.post("rl-2fa/validate-secret",{secret:this.generatedSecret,code:this.oneTimePassword}).then(e=>{this.isLoading2Fa=!1,"OK"===e.data.status&&this.saveOneTimePassword()}).catch(e=>{this.isLoading2Fa=!1,this.oneTimePasswordError=e.response.data.error})},saveOneTimePassword(){this.user.customFields||this.$set(this.user,"customFields",{}),this.user.customFields.rl_2fa_secret=this.generatedSecret,this.onSave()},disable2FA(){this.user.customFields||this.$set(this.user,"customFields",{}),this.user.customFields.rl_2fa_secret="",this.onSave()}}}},382:function(e,t,r){var n=r(950);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals),r(346).Z("67e31fb7",n,!0,{})},346:function(e,t,r){"use strict";function n(e,t){for(var r=[],n={},s=0;s<t.length;s++){var a=t[s],i=a[0],o={id:e+":"+s,css:a[1],media:a[2],sourceMap:a[3]};n[i]?n[i].parts.push(o):r.push(n[i]={id:i,parts:[o]})}return r}r.d(t,{Z:function(){return p}});var s="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!s)throw Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var a={},i=s&&(document.head||document.getElementsByTagName("head")[0]),o=null,l=0,d=!1,c=function(){},u=null,f="data-vue-ssr-id",h="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,t,r,s){d=r,u=s||{};var i=n(e,t);return g(i),function(t){for(var r=[],s=0;s<i.length;s++){var o=a[i[s].id];o.refs--,r.push(o)}t?g(i=n(e,t)):i=[];for(var s=0;s<r.length;s++){var o=r[s];if(0===o.refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete a[o.id]}}}}function g(e){for(var t=0;t<e.length;t++){var r=e[t],n=a[r.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](r.parts[s]);for(;s<r.parts.length;s++)n.parts.push(m(r.parts[s]));n.parts.length>r.parts.length&&(n.parts.length=r.parts.length)}else{for(var i=[],s=0;s<r.parts.length;s++)i.push(m(r.parts[s]));a[r.id]={id:r.id,refs:1,parts:i}}}}function v(){var e=document.createElement("style");return e.type="text/css",i.appendChild(e),e}function m(e){var t,r,n=document.querySelector("style["+f+'~="'+e.id+'"]');if(n){if(d)return c;n.parentNode.removeChild(n)}if(h){var s=l++;t=b.bind(null,n=o||(o=v()),s,!1),r=b.bind(null,n,s,!0)}else t=S.bind(null,n=v()),r=function(){n.parentNode.removeChild(n)};return t(e),function(n){n?(n.css!==e.css||n.media!==e.media||n.sourceMap!==e.sourceMap)&&t(e=n):r()}}var w=function(){var e=[];return function(t,r){return e[t]=r,e.filter(Boolean).join("\n")}}();function b(e,t,r,n){var s=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=w(t,s);else{var a=document.createTextNode(s),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}function S(e,t){var r=t.css,n=t.media,s=t.sourceMap;if(n&&e.setAttribute("media",n),u.ssrId&&e.setAttribute(f,t.id),s&&(r+="\n/*# sourceURL="+s.sources[0]+" */\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}}}]);
//# sourceMappingURL=758.js.map